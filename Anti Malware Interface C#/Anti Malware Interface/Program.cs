using System;
using System.IO;
using System.Reflection;
using MalwareScan.AMSI;

namespace Anti_Malware_Interface
{
    class Program
    {
        static void Main(string[] args)
        {
            Testings.AllTests();
        }
    }
    class Testings
    {
        static MalwareScanner scanner = new MalwareScanner("MyApplications Viruscanner");

        public static void AllTests()
        {
            Test1();
        }
        public static void Test1()
        {
            string teststring = @"X5O!P%@AP[4\PZX54(P^)7CC)7}" + @"$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";

            var result = scanner.HasVirus(teststring, "filename");
            if(result == true)
                Console.ForegroundColor = ConsoleColor.Green;
            else
                Console.ForegroundColor = ConsoleColor.Red;

            Console.WriteLine("Test1: Malware = " + result.ToString());
            Console.ForegroundColor = ConsoleColor.White;
        }
    }
}
